Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cluster nodes: 1999
Provided resources: res=1
Job counts:
	count	jobs
	1	VEP_annotate
	1	all
	1	annovar_intervar
	1	make_gemini_db
	1	merge_annovar_intervar
	1	merge_vcf
	1	move_reports
	1	peddy_QC
	1	query_gemini
	3	query_gemini_individual
	1	spliceai
	1	spliceai_edit
	1	spliceai_intervar_edit
	1	tweak_header
	1	vcfanno_annotate
	17

[Thu Jul  4 14:13:58 2019]
rule annovar_intervar:
    input: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz, temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi
    output: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt.intervar
    jobid: 16
    reason: Missing output files: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt.intervar, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y
    threads: 2


		module unload python
		module load intervar/2.1.2
		convert2annovar.pl -format vcf4old temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz -includeinfo --outfile temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput
		table_annovar.pl temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput 			$ANNOVAR_DATA/hg19 			-buildver hg19 			-remove 			-out temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput 			--protocol refGene,esp6500siv2_all,1000g2015aug_all,avsnp147,dbnsfp33a,clinvar_20190305,gnomad_genome,dbscsnv11,dbnsfp31a_interpro,rmsk,ensGene,knownGene,refGeneWithVer,popfreq_max_20150413,gnomad_exome,spidex,avsnp150,spliceai_filtered 			-operation  g,f,f,f,f,f,f,f,f,r,g,g,g,f,f,f,f,f 			--argument '-hgvs',,,,,,,,,,,,'-splicing 50 -hgvs',,,,, 			--polish -nastring . 		    --thread 2 			--otherinfo
		InterVar 			-i temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput 			--input_type=AVinput 			-d $ANNOVAR_DATA/hg19 			--evidence_file=/data/OGVFB/OGL_NGS/OGL.variants.evidence.txt 			-o temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput 			--skip_annovar
		
Submitted job 16 with external jobid '30735377'.

[Thu Jul  4 14:13:59 2019]
rule VEP_annotate:
    input: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    output: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz.tbi
    jobid: 12
    reason: Forced execution
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y


		module load VEP/96
		module load samtools/1.9
		vep -i temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz --offline 			--cache --dir_cache $VEPCACHEDIR 			--fasta $VEPCACHEDIR/GRCh37.fa --species human --assembly GRCh37  			--format vcf 			--output_file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz 			--plugin dbscSNV,$VEPCACHEDIR/dbscSNV1.1.txt.gz             --plugin GeneSplicer,$GS/bin/genesplicer,$GS/human,context=200             --plugin SpliceRegion 			--plugin MaxEntScan,/data/OGVFB/resources/MaxEntScan 			--plugin CADD,/fdb/CADD/1.3/prescored/whole_genome_SNVs.tsv.gz,/fdb/CADD/1.3/prescored/InDels.tsv.gz 			--plugin MPC,/data/OGVFB/OGL_NGS/variant_prioritization/data/MPC/fordist_constraint_official_mpc_values_v2.txt.gz 			--canonical 			--ccds 			--total_length 			--hgvs 			--shift_hgvs 1 			--sift b 			--polyphen b 			--symbol 			--check_existing 			--numbers 			--biotype 			--total_length 			--pubmed 			--domains 			--gene_phenotype 			--max_af 			--pick_allele_gene  --pick_order canonical, tsl, biotype, ccds, length              --fields Allele,Consequence,Codons,Amino_acids,Gene,SYMBOL,Feature,EXON,HGVSc,HGVSp,MAX_AF,MAX_AF_POPS,PolyPhen,SIFT,MPC,Protein_position,BIOTYPE,CANONICAL,DOMAINS,Existing_variation,CLIN_SIG,PICK,PUBMED,Phenotypes,CADD_RAW,CADD_PHRED,GeneSplicer,SpliceRegion,ada_score,rf_score,MaxEntScan_diff 			--vcf --compress_output bgzip --force_overwrite
		# tabix
		tabix -f -p vcf temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz
		
Submitted job 12 with external jobid '30735378'.

[Thu Jul  4 14:14:00 2019]
rule spliceai:
    input: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    output: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz, temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi
    jobid: 18
    reason: Missing output files: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y


		module load spliceai/20190507
		module load samtools/1.9
		spliceai -I temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz -R /data/OGVFB/resources/1000G_phase2_GRCh37/human_g1k_v37_decoy.fasta -A grch37 -O temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
		tabix -f -p vcf temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
		
Submitted job 18 with external jobid '30735379'.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz.tbi.
[Thu Jul  4 14:18:58 2019]
Finished job 12.
1 of 17 steps (6%) done
Removing temporary output file temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi.
[Thu Jul  4 14:20:38 2019]
Finished job 18.
2 of 17 steps (12%) done

[Thu Jul  4 14:20:38 2019]
rule spliceai_edit:
    input: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    output: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv, temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv.cut
    jobid: 15
    reason: Missing output files: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv.cut; Input files updated by another job: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y


	 	module load samtools/1.9
		module load VCF-kit/0.1.6
		vk vcf2tsv wide --print-header temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz > temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv
		cut -f 1-5,$(head -1 temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv | sed "s/\t/\n/g" | grep -n "SpliceAI" | cut -f 1 -d:) temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv 		| awk -F"	" 'BEGIN{OFS="	"} !/,/ {split($6, splices, "|"); max = splices[3]; for(m = 3; m <=6; m++) {if(max<splices[m]) max = splices[m]} print $0,max} /,/ {n = split($6,annotation,","); max = 0; for (i = 1; i <=n; i++) {split(annotation[i],splices,"|"); for(m = 3; m <=6; m++) {if(max<splices[m]) max = splices[m]}; }; print $0,max }' - 		| awk -F"	" 'BEGIN{OFS="	"} NR==1 {$7="spliceai_maxscore"; print $0} NR>1 {if ($6==".") {$7="."; print $0} else {print $0} }' - 		| awk -F"	" 'BEGIN{OFS="	"} NR==1 {$8="spliceai_rank"; print $6, $7, $8} NR>1 { if ($7==".") {$8 = 0} else { if ($7 >= 0.8) {$8 = 8} else {if ($7 >= 0.5) {$8 = 6} else {if ($7 >= 0.2) {$8 = 3} else {if ($7 >= 0.15) {$8 = 1} else {$8 = 0}}} }}; print $6, $7, $8}' -  > temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv.cut
		
Submitted job 15 with external jobid '30735681'.
Removing temporary output file temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.
Removing temporary output file temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv.
[Thu Jul  4 14:21:38 2019]
Finished job 15.
3 of 17 steps (18%) done
Removing temporary output file temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi.
Removing temporary output file temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.
[Thu Jul  4 14:35:09 2019]
Finished job 16.
4 of 17 steps (24%) done

[Thu Jul  4 14:35:09 2019]
rule spliceai_intervar_edit:
    input: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv.cut, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt.intervar
    output: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.spliceai.txt, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.spliceai_annovar_intervar
    jobid: 13
    reason: Missing output files: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.spliceai_annovar_intervar; Input files updated by another job: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt.intervar, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt, temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv.cut
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y


		module load R/3.5
		cut -f -132 temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt | sed "1 s/"Otherinfo"/"CHROM\	POS\	ID\	REF\	ALT\	QUAL\	FILTER"/" - | paste - temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv.cut > temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.spliceai.txt
		Rscript /home/$USER/git/variant_prioritization/src/intervar_v1.6.R 			temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt.intervar 			temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.spliceai.txt 			temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.spliceai_annovar_intervar
		
Submitted job 13 with external jobid '30736164'.
Removing temporary output file temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv.cut.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt.intervar.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.spliceai.txt.
[Thu Jul  4 14:37:09 2019]
Finished job 13.
5 of 17 steps (29%) done

[Thu Jul  4 14:37:09 2019]
rule merge_annovar_intervar:
    input: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.spliceai_annovar_intervar
    output: temp/spliceai_annovar_intervar_annotation.txt.gz
    jobid: 11
    reason: Missing output files: temp/spliceai_annovar_intervar_annotation.txt.gz; Input files updated by another job: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.spliceai_annovar_intervar


		module load samtools/1.9
		head -n 1 temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.spliceai_annovar_intervar | grep "^CHROM" | uniq > temp/annovar_intervar_header
		cat temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.spliceai_annovar_intervar | grep -v "^CHROM" | sort -k1,1 -k2,2n > temp/spliceai_annovar_intervar_annotation.txt.gzTEMP
		cat temp/annovar_intervar_header temp/spliceai_annovar_intervar_annotation.txt.gzTEMP | bgzip -f > temp/spliceai_annovar_intervar_annotation.txt.gz
		tabix -b 2 -e 2 -S 1 temp/spliceai_annovar_intervar_annotation.txt.gz
		
Submitted job 11 with external jobid '30736226'.
Waiting at most 120 seconds for missing files.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.spliceai_annovar_intervar.
[Thu Jul  4 14:37:39 2019]
Finished job 11.
6 of 17 steps (35%) done

[Thu Jul  4 14:37:39 2019]
rule vcfanno_annotate:
    input: temp/spliceai_annovar_intervar_annotation.txt.gz, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz
    output: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y_vcfanno.conf, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.vcf.gz, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.vcf.gz.tbi
    jobid: 10
    reason: Missing output files: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.vcf.gz; Input files updated by another job: temp/spliceai_annovar_intervar_annotation.txt.gz, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y
    threads: 4


		module load samtools/1.9
		module load vcfanno/0.2.9
		# copy conf to local dir, then edit to put in the path
		# to the annovar_intervar this Snakemake creates
		cp /home/$USER/git/variant_prioritization/src/vcfanno_v4.conf temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y_vcfanno.conf
		annovar_intervar_path=`echo temp/spliceai_annovar_intervar_annotation.txt.gz | sed 's:/:\\\/:g'`
		sed -i "s/ANNOVAR_INTERVAR_FILE/$annovar_intervar_path/g" temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y_vcfanno.conf
		vcfanno -p 4 -lua /home/$USER/git/variant_prioritization/src/vcfanno_custom.lua temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y_vcfanno.conf temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz | bgzip > temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.vcf.gz
		tabix -f -p vcf temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.vcf.gz
		
Submitted job 10 with external jobid '30736227'.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y_vcfanno.conf.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.vcf.gz.tbi.
[Thu Jul  4 14:43:19 2019]
Finished job 10.
7 of 17 steps (41%) done

[Thu Jul  4 14:43:19 2019]
rule tweak_header:
    input: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.vcf.gz
    output: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz.tbi
    jobid: 9
    reason: Missing output files: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz.tbi, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz; Input files updated by another job: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.vcf.gz
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y


		module load samtools/1.9
		zcat temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.vcf.gz | sed 's/Number=A/Number=1/g' | bgzip -c > temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz
		tabix -f -p vcf temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz
		
Submitted job 9 with external jobid '30736272'.
Waiting at most 120 seconds for missing files.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.vcf.gz.
[Thu Jul  4 14:43:49 2019]
Finished job 9.
8 of 17 steps (47%) done

[Thu Jul  4 14:43:49 2019]
rule merge_vcf:
    input: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz.tbi
    output: test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz, test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz.tbi
    jobid: 8
    reason: Missing output files: test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz; Input files updated by another job: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz.tbi, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz
    wildcards: sample=test_trio
    threads: 16


		export REF_CACHE=/scratch/$SLURM_JOB_ID/
		module load samtools/1.9
		bcftools concat --threads 16 temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.VCFANNO.NUMFIX.vcf.gz | bcftools sort -T /scratch/$SLURM_JOB_ID/ -m 100G -O z -o test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz
		tabix -f -p vcf test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz
		
Submitted job 8 with external jobid '30736274'.
Waiting at most 120 seconds for missing files.
[Thu Jul  4 14:44:49 2019]
Finished job 8.
9 of 17 steps (53%) done

[Thu Jul  4 14:44:49 2019]
rule peddy_QC:
    input: test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz
    output: test_trio_PEDDY.ped_check.csv, test_trio_PEDDY.het_check.csv, test_trio_PEDDY.sex_check.csv
    jobid: 7
    reason: Missing output files: test_trio_PEDDY.sex_check.csv, test_trio_PEDDY.het_check.csv, test_trio_PEDDY.ped_check.csv; Input files updated by another job: test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz
    wildcards: sample=test_trio
    threads: 4


		module load peddy/0.3.1
		peddy -p 4 test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz test_trio.ped --prefix test_trio_PEDDY
		
Submitted job 7 with external jobid '30736299'.

[Thu Jul  4 14:44:51 2019]
rule make_gemini_db:
    input: test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz
    output: test_trio.PED_test_trio.gemini.db
    jobid: 6
    reason: Missing output files: test_trio.PED_test_trio.gemini.db; Input files updated by another job: test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz
    wildcards: sample=test_trio, ped=test_trio


		module load vcf2db/2017.12.11
		echo test_trio.ped
		vcf2db.py test_trio.SORTED.VT.VEP.VCFANNO.vcf.gz test_trio.ped test_trio.PED_test_trio.gemini.db
		
Submitted job 6 with external jobid '30736300'.
[Thu Jul  4 14:45:29 2019]
Finished job 7.
10 of 17 steps (59%) done
[Thu Jul  4 14:47:10 2019]
Finished job 6.
11 of 17 steps (65%) done

[Thu Jul  4 14:47:10 2019]
localrule query_gemini_individual:
    input: test_trio.PED_test_trio.gemini.db
    output: test_trio.test_trio.Father.gemini.tsv, test_trio.test_trio.Father.gemini.sorted.tsv
    jobid: 3
    reason: Missing output files: test_trio.test_trio.Father.gemini.sorted.tsv; Input files updated by another job: test_trio.PED_test_trio.gemini.db
    wildcards: sample=test_trio, ped=test_trio, sampleid=Father


		module load R/3.5
		module load gemini/0.20.1
 		gemini query -q 		"SELECT chrom, start, end, ref, alt, qual, filter, Chr_annovar, Start_annovar, End_annovar, Ref_annovar, Alt_annovar, Priority_Score_intervar, gene, exon, aa_length, hgvsc, hgvsp, Ref_Gene_annovar, Func_refGene_annovar, Gene_refGeneWithVer_annovar, GeneDetail_refGeneWithVer_annovar, ExonicFunc_refGeneWithVer_annovar, AAChange_refGeneWithVer_annovar, hgmd_overlap, existing_variation, pubmed, Clinvar_intervar, intervar_and_evidence, clinvar_id, clinvar_pathogenic, clinvar_sig, clin_sig, PopFreqMax_annovar, gnomAD_exome_ALL_annovar, gnomAD_genome_ALL_annovar, Freq_esp6500siv2_all_annovar, Freq_1000g2015aug_all_annovar, aaf_esp_all, aaf_1kg_all, af_exac_all, max_af, max_af_pops, exac_num_hom_alt, gno_hom, dbscSNV_ADA_SCORE_intervar, dbscSNV_RF_SCORE_intervar, dpsi_max_tissue_annovar, dpsi_zscore_annovar, spliceai, spliceai_maxscore, spliceai_filtered, genesplicer, MaxEntScan_diff, branchpoint_u2_binding_energy, branchpoint_prob, branchpoint_to_3prime, SIFT_score_intervar, MetaSVM_score_intervar, clinpred_score, mpc, CADD_raw_intervar, CADD_phred_intervar, GERP_RS_intervar, phyloP46way_placental_intervar, primatedl, Func_refGeneWithVer_annovar, ExonicFunc_refGene_intervar, avsnp150_annovar, Interpro_domain_intervar, pfam_domain, tfbs, pli, lof_z, mis_z, sigmaaf_lof_0001, sigmaaf_lof_01, sigmaaf_missense_0001, sigmaaf_missense_01, omim_genesymbol, omim_inheritance, omim_phenotypes, atac_rpe_itemrgb, atac_rpe_score, eyeintegration_rnaseq_tpm_rpe_adulttissue, eyeintegration_rnaseq_tpm_rpe_cellline, eyeintegration_rnaseq_tpm_rpe_fetaltissue, eyeintegration_rnaseq_tpm_rpe_stemcellline, eyeintegration_rnaseq_tpm_retina_adulttissue, eyeintegration_rnaseq_tpm_retina_stemcellline, eyeintegration_rnaseq_tpm_wholeblood, gt_types.Father, gts.Father, gt_phases.Father, gt_depths.Father, gt_alt_freqs.Father, gt_quals.Father FROM variants WHERE gno_af_all < 0.2 AND af_exac_all < 0.2 AND (priority_score_intervar >= 0 OR priority_score_intervar = -1 OR priority_score_intervar = -2) " 		--header --gt-filter "gt_types.Father != HOM_REF AND gt_depths.Father > 2 AND gt_quals.Father > 5" test_trio.PED_test_trio.gemini.db > test_trio.test_trio.Father.gemini.tsv
		Rscript /home/$USER/git/variant_prioritization/src/sortGeminiTSV.R 			test_trio.test_trio.Father.gemini.tsv test_trio.test_trio.Father.gemini.sorted.tsv /data/OGVFB/OGL_NGS/variant_prioritization/data/OGLv1_panel_DxORcandidate.txt
 		

[Thu Jul  4 14:47:10 2019]
localrule query_gemini_individual:
    input: test_trio.PED_test_trio.gemini.db
    output: test_trio.test_trio.Mother.gemini.tsv, test_trio.test_trio.Mother.gemini.sorted.tsv
    jobid: 4
    reason: Missing output files: test_trio.test_trio.Mother.gemini.sorted.tsv; Input files updated by another job: test_trio.PED_test_trio.gemini.db
    wildcards: sample=test_trio, ped=test_trio, sampleid=Mother


		module load R/3.5
		module load gemini/0.20.1
 		gemini query -q 		"SELECT chrom, start, end, ref, alt, qual, filter, Chr_annovar, Start_annovar, End_annovar, Ref_annovar, Alt_annovar, Priority_Score_intervar, gene, exon, aa_length, hgvsc, hgvsp, Ref_Gene_annovar, Func_refGene_annovar, Gene_refGeneWithVer_annovar, GeneDetail_refGeneWithVer_annovar, ExonicFunc_refGeneWithVer_annovar, AAChange_refGeneWithVer_annovar, hgmd_overlap, existing_variation, pubmed, Clinvar_intervar, intervar_and_evidence, clinvar_id, clinvar_pathogenic, clinvar_sig, clin_sig, PopFreqMax_annovar, gnomAD_exome_ALL_annovar, gnomAD_genome_ALL_annovar, Freq_esp6500siv2_all_annovar, Freq_1000g2015aug_all_annovar, aaf_esp_all, aaf_1kg_all, af_exac_all, max_af, max_af_pops, exac_num_hom_alt, gno_hom, dbscSNV_ADA_SCORE_intervar, dbscSNV_RF_SCORE_intervar, dpsi_max_tissue_annovar, dpsi_zscore_annovar, spliceai, spliceai_maxscore, spliceai_filtered, genesplicer, MaxEntScan_diff, branchpoint_u2_binding_energy, branchpoint_prob, branchpoint_to_3prime, SIFT_score_intervar, MetaSVM_score_intervar, clinpred_score, mpc, CADD_raw_intervar, CADD_phred_intervar, GERP_RS_intervar, phyloP46way_placental_intervar, primatedl, Func_refGeneWithVer_annovar, ExonicFunc_refGene_intervar, avsnp150_annovar, Interpro_domain_intervar, pfam_domain, tfbs, pli, lof_z, mis_z, sigmaaf_lof_0001, sigmaaf_lof_01, sigmaaf_missense_0001, sigmaaf_missense_01, omim_genesymbol, omim_inheritance, omim_phenotypes, atac_rpe_itemrgb, atac_rpe_score, eyeintegration_rnaseq_tpm_rpe_adulttissue, eyeintegration_rnaseq_tpm_rpe_cellline, eyeintegration_rnaseq_tpm_rpe_fetaltissue, eyeintegration_rnaseq_tpm_rpe_stemcellline, eyeintegration_rnaseq_tpm_retina_adulttissue, eyeintegration_rnaseq_tpm_retina_stemcellline, eyeintegration_rnaseq_tpm_wholeblood, gt_types.Mother, gts.Mother, gt_phases.Mother, gt_depths.Mother, gt_alt_freqs.Mother, gt_quals.Mother FROM variants WHERE gno_af_all < 0.2 AND af_exac_all < 0.2 AND (priority_score_intervar >= 0 OR priority_score_intervar = -1 OR priority_score_intervar = -2) " 		--header --gt-filter "gt_types.Mother != HOM_REF AND gt_depths.Mother > 2 AND gt_quals.Mother > 5" test_trio.PED_test_trio.gemini.db > test_trio.test_trio.Mother.gemini.tsv
		Rscript /home/$USER/git/variant_prioritization/src/sortGeminiTSV.R 			test_trio.test_trio.Mother.gemini.tsv test_trio.test_trio.Mother.gemini.sorted.tsv /data/OGVFB/OGL_NGS/variant_prioritization/data/OGLv1_panel_DxORcandidate.txt
 		

[Thu Jul  4 14:47:10 2019]
localrule query_gemini:
    input: test_trio.PED_test_trio.gemini.db, test_trio_PEDDY.ped_check.csv, test_trio_PEDDY.het_check.csv, test_trio_PEDDY.sex_check.csv
    output: test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html
    jobid: 5
    reason: Missing output files: test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html; Input files updated by another job: test_trio.PED_test_trio.gemini.db, test_trio_PEDDY.sex_check.csv, test_trio_PEDDY.ped_check.csv, test_trio_PEDDY.het_check.csv
    wildcards: sample=test_trio, family_name=outside, ped=test_trio, gemini_lenient=Yes
    resources: res=1

mkdir -p sample_reports; 					module load R/3.5; 					module load gemini/0.20.1; 					module load pandoc/2.1.1; 					Rscript /home/$USER/git/variant_prioritization/src/GEMINI_db_to_SeeGEM.R 						test_trio.PED_test_trio.gemini.db 						outside 						test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html 						test_trio_PEDDY 						1.1 						Yes test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.tsv
[Thu Jul  4 14:47:10 2019]
localrule query_gemini_individual:
    input: test_trio.PED_test_trio.gemini.db
    output: test_trio.test_trio.Proband.gemini.tsv, test_trio.test_trio.Proband.gemini.sorted.tsv
    jobid: 2
    reason: Missing output files: test_trio.test_trio.Proband.gemini.sorted.tsv; Input files updated by another job: test_trio.PED_test_trio.gemini.db
    wildcards: sample=test_trio, ped=test_trio, sampleid=Proband


		module load R/3.5
		module load gemini/0.20.1
 		gemini query -q 		"SELECT chrom, start, end, ref, alt, qual, filter, Chr_annovar, Start_annovar, End_annovar, Ref_annovar, Alt_annovar, Priority_Score_intervar, gene, exon, aa_length, hgvsc, hgvsp, Ref_Gene_annovar, Func_refGene_annovar, Gene_refGeneWithVer_annovar, GeneDetail_refGeneWithVer_annovar, ExonicFunc_refGeneWithVer_annovar, AAChange_refGeneWithVer_annovar, hgmd_overlap, existing_variation, pubmed, Clinvar_intervar, intervar_and_evidence, clinvar_id, clinvar_pathogenic, clinvar_sig, clin_sig, PopFreqMax_annovar, gnomAD_exome_ALL_annovar, gnomAD_genome_ALL_annovar, Freq_esp6500siv2_all_annovar, Freq_1000g2015aug_all_annovar, aaf_esp_all, aaf_1kg_all, af_exac_all, max_af, max_af_pops, exac_num_hom_alt, gno_hom, dbscSNV_ADA_SCORE_intervar, dbscSNV_RF_SCORE_intervar, dpsi_max_tissue_annovar, dpsi_zscore_annovar, spliceai, spliceai_maxscore, spliceai_filtered, genesplicer, MaxEntScan_diff, branchpoint_u2_binding_energy, branchpoint_prob, branchpoint_to_3prime, SIFT_score_intervar, MetaSVM_score_intervar, clinpred_score, mpc, CADD_raw_intervar, CADD_phred_intervar, GERP_RS_intervar, phyloP46way_placental_intervar, primatedl, Func_refGeneWithVer_annovar, ExonicFunc_refGene_intervar, avsnp150_annovar, Interpro_domain_intervar, pfam_domain, tfbs, pli, lof_z, mis_z, sigmaaf_lof_0001, sigmaaf_lof_01, sigmaaf_missense_0001, sigmaaf_missense_01, omim_genesymbol, omim_inheritance, omim_phenotypes, atac_rpe_itemrgb, atac_rpe_score, eyeintegration_rnaseq_tpm_rpe_adulttissue, eyeintegration_rnaseq_tpm_rpe_cellline, eyeintegration_rnaseq_tpm_rpe_fetaltissue, eyeintegration_rnaseq_tpm_rpe_stemcellline, eyeintegration_rnaseq_tpm_retina_adulttissue, eyeintegration_rnaseq_tpm_retina_stemcellline, eyeintegration_rnaseq_tpm_wholeblood, gt_types.Proband, gts.Proband, gt_phases.Proband, gt_depths.Proband, gt_alt_freqs.Proband, gt_quals.Proband FROM variants WHERE gno_af_all < 0.2 AND af_exac_all < 0.2 AND (priority_score_intervar >= 0 OR priority_score_intervar = -1 OR priority_score_intervar = -2) " 		--header --gt-filter "gt_types.Proband != HOM_REF AND gt_depths.Proband > 2 AND gt_quals.Proband > 5" test_trio.PED_test_trio.gemini.db > test_trio.test_trio.Proband.gemini.tsv
		Rscript /home/$USER/git/variant_prioritization/src/sortGeminiTSV.R 			test_trio.test_trio.Proband.gemini.tsv test_trio.test_trio.Proband.gemini.sorted.tsv /data/OGVFB/OGL_NGS/variant_prioritization/data/OGLv1_panel_DxORcandidate.txt
 		
Removing temporary output file test_trio.test_trio.Father.gemini.tsv.
[Thu Jul  4 14:47:18 2019]
Finished job 3.
12 of 17 steps (71%) done
Removing temporary output file test_trio.test_trio.Mother.gemini.tsv.
[Thu Jul  4 14:47:19 2019]
Finished job 4.
13 of 17 steps (76%) done
Removing temporary output file test_trio.test_trio.Proband.gemini.tsv.
[Thu Jul  4 14:47:24 2019]
Finished job 2.
14 of 17 steps (82%) done
[Thu Jul  4 14:47:41 2019]
Finished job 5.
15 of 17 steps (88%) done

[Thu Jul  4 14:47:41 2019]
localrule move_reports:
    input: test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html
    output: sample_reports/test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html
    jobid: 1
    reason: Missing output files: sample_reports/test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html; Input files updated by another job: test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html
    wildcards: sample=test_trio, family_name=outside, ped=test_trio, gemini_lenient=Yes


		mv test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html sample_reports/test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html
		
[Thu Jul  4 14:47:41 2019]
Finished job 1.
16 of 17 steps (94%) done

[Thu Jul  4 14:47:41 2019]
localrule all:
    input: sample_reports/test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html, test_trio.test_trio.Proband.gemini.sorted.tsv, test_trio.test_trio.Father.gemini.sorted.tsv, test_trio.test_trio.Mother.gemini.sorted.tsv
    jobid: 0
    reason: Input files updated by another job: test_trio.test_trio.Father.gemini.sorted.tsv, sample_reports/test_trio.outside.PED_test_trio.lenientYes.SeeGEM.report.html, test_trio.test_trio.Proband.gemini.sorted.tsv, test_trio.test_trio.Mother.gemini.sorted.tsv

[Thu Jul  4 14:47:41 2019]
Finished job 0.
17 of 17 steps (100%) done
Complete log: /spin1/home/linux/guanb/git/variant_prioritization/tests/.snakemake/log/2019-07-04T141358.004735.snakemake.log
