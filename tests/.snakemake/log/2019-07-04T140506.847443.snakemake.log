Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cluster nodes: 1999
Provided resources: res=1
Job counts:
	count	jobs
	1	VEP_annotate
	1	all
	1	annovar_intervar
	1	make_gemini_db
	1	merge_annovar_intervar
	1	merge_vcf
	1	move_reports
	1	n_split_vcf
	1	peddy_QC
	1	query_gemini
	3	query_gemini_individual
	1	spliceai
	1	spliceai_edit
	1	spliceai_intervar_edit
	1	tweak_header
	1	vcfanno_annotate
	1	vt_bgzip_and_tabix_vcf
	19

[Thu Jul  4 14:05:06 2019]
rule n_split_vcf:
    input: test_trio.vcf.gz
    output: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi
    jobid: 17
    reason: Missing output files: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y


		export REF_CACHE=/scratch/$SLURM_JOB_ID/
		module load samtools/1.9
		if [[ 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y != "MT_contigs" ]]; then
			bcftools view -r 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y test_trio.vcf.gz | bgzip > temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
		else
			bcftools view -r MT,GL000207.1,GL000226.1,GL000229.1,GL000231.1,GL000210.1,GL000239.1,GL000235.1,GL000201.1,GL000247.1,GL000245.1,GL000197.1,GL000203.1,GL000246.1,GL000249.1,GL000196.1,GL000248.1,GL000244.1,GL000238.1,GL000202.1,GL000234.1,GL000232.1,GL000206.1,GL000240.1,GL000236.1,GL000241.1,GL000243.1,GL000242.1,GL000230.1,GL000237.1,GL000233.1,GL000204.1,GL000198.1,GL000208.1,GL000191.1,GL000227.1,GL000228.1,GL000214.1,GL000221.1,GL000209.1,GL000218.1,GL000220.1,GL000213.1,GL000211.1,GL000199.1,GL000217.1,GL000216.1,GL000215.1,GL000205.1,GL000219.1,GL000224.1,GL000223.1,GL000195.1,GL000212.1,GL000222.1,GL000200.1,GL000193.1,GL000194.1,GL000225.1,GL000192.1,NC_007605 test_trio.vcf.gz | bgzip > temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
		fi
		tabix -p vcf temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
		
Submitted job 17 with external jobid '30734899'.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi.
[Thu Jul  4 14:07:07 2019]
Finished job 17.
1 of 19 steps (5%) done

[Thu Jul  4 14:07:07 2019]
rule vt_bgzip_and_tabix_vcf:
    input: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    output: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz, temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi
    jobid: 14
    reason: Missing output files: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi, temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz; Input files updated by another job: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y


		export REF_CACHE=/scratch/$SLURM_JOB_ID/
		module load samtools/1.9
		module load vt/0.577
		zcat temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz 			| sed 's/ID=AD,Number=./ID=AD,Number=R/' 			| vt decompose -s - 			| vt normalize -r /data/OGVFB/resources/1000G_phase2_GRCh37/human_g1k_v37_decoy.fasta - 			| bgzip -c > temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
		tabix -f -p vcf temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
		
Submitted job 14 with external jobid '30734932'.
Removing temporary output file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.
[Thu Jul  4 14:08:07 2019]
Finished job 14.
2 of 19 steps (11%) done

[Thu Jul  4 14:08:07 2019]
rule annovar_intervar:
    input: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz, temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi
    output: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt.intervar
    jobid: 16
    reason: Missing output files: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput.hg19_multianno.txt.intervar; Input files updated by another job: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi, temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y
    threads: 2


		module unload python
		module load intervar/2.1.2
		convert2annovar.pl -format vcf4old temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz -includeinfo --outfile temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput
		table_annovar.pl temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput 			$ANNOVAR_DATA/hg19 			-buildver hg19 			-remove 			-out temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput 			--protocol refGene,esp6500siv2_all,1000g2015aug_all,avsnp147,dbnsfp33a,clinvar_20190305,gnomad_genome,dbscsnv11,dbnsfp31a_interpro,rmsk,ensGene,knownGene,refGeneWithVer,popfreq_max_20150413,gnomad_exome,spidex,avsnp150,spliceai_filtered 			-operation  g,f,f,f,f,f,f,f,f,r,g,g,g,f,f,f,f,f 			--argument '-hgvs',,,,,,,,,,,,'-splicing 50 -hgvs',,,,, 			--polish -nastring . 		    --thread 2 			--otherinfo
		InterVar 			-i temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput 			--input_type=AVinput 			-d $ANNOVAR_DATA/hg19 			--evidence_file=/data/OGVFB/OGL_NGS/OGL.variants.evidence.txt 			-o temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.avinput 			--skip_annovar
		
Submitted job 16 with external jobid '30735135'.

[Thu Jul  4 14:08:08 2019]
rule spliceai:
    input: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    output: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz, temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz.tbi
    jobid: 18
    reason: Missing output files: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz; Input files updated by another job: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y


		module load spliceai/20190507
		module load samtools/1.9
		spliceai -I temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz -R /data/OGVFB/resources/1000G_phase2_GRCh37/human_g1k_v37_decoy.fasta -A grch37 -O temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
		tabix -f -p vcf temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
		
Submitted job 18 with external jobid '30735136'.

[Thu Jul  4 14:08:09 2019]
rule VEP_annotate:
    input: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    output: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz, temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz.tbi
    jobid: 12
    reason: Missing output files: temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz; Input files updated by another job: temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y


		module load VEP/96
		module load samtools/1.9
		vep -i temp/vt.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz --offline 			--cache --dir_cache $VEPCACHEDIR 			--fasta $VEPCACHEDIR/GRCh37.fa --species human --assembly GRCh37  			--format vcf 			--output_file temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz 			--plugin dbscSNV,$VEPCACHEDIR/dbscSNV1.1.txt.gz             --plugin GeneSplicer,$GS/bin/genesplicer,$GS/human,context=200             --plugin SpliceRegion 			--plugin MaxEntScan,/data/OGVFB/resources/MaxEntScan 			--plugin CADD,/fdb/CADD/1.3/prescored/whole_genome_SNVs.tsv.gz,/fdb/CADD/1.3/prescored/InDels.tsv.gz 			--plugin MPC,/data/OGVFB/OGL_NGS/variant_prioritization/data/MPC/fordist_constraint_official_mpc_values_v2.txt.gz 			--canonical 			--ccds 			--total_length 			--hgvs 			--shift_hgvs 1 			--sift b 			--polyphen b 			--symbol 			--check_existing 			--numbers 			--biotype 			--total_length 			--pubmed 			--domains 			--gene_phenotype 			--max_af 			--pick_allele_gene  --pick_order canonical, tsl, biotype, ccds, length              --fields Allele,Consequence,Codons,Amino_acids,Gene,SYMBOL,Feature,EXON,HGVSc,HGVSp,MAX_AF,MAX_AF_POPS,PolyPhen,SIFT,MPC,Protein_position,BIOTYPE,CANONICAL,DOMAINS,Existing_variation,CLIN_SIG,PICK,PUBMED,Phenotypes,CADD_RAW,CADD_PHRED,GeneSplicer,SpliceRegion,ada_score,rf_score,MaxEntScan_diff 			--vcf --compress_output bgzip --force_overwrite
		# tabix
		tabix -f -p vcf temp/test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.SORTED.VT.VEP.vcf.gz
		
Submitted job 12 with external jobid '30735137'.
Terminating processes on user request, this might take some time.
Will exit after finishing currently running jobs.
Cancelling snakemake on user request.
