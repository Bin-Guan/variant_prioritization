Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	spliceai_edit
	1

[Thu Jul  4 14:21:11 2019]
rule spliceai_edit:
    input: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz
    output: temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv, temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv.cut
    jobid: 0
    wildcards: sample=test_trio, region=1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y


	 	module load samtools/1.9
		module load VCF-kit/0.1.6
		vk vcf2tsv wide --print-header temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.vcf.gz > temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv
		cut -f 1-5,$(head -1 temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv | sed "s/\t/\n/g" | grep -n "SpliceAI" | cut -f 1 -d:) temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv 		| awk -F"	" 'BEGIN{OFS="	"} !/,/ {split($6, splices, "|"); max = splices[3]; for(m = 3; m <=6; m++) {if(max<splices[m]) max = splices[m]} print $0,max} /,/ {n = split($6,annotation,","); max = 0; for (i = 1; i <=n; i++) {split(annotation[i],splices,"|"); for(m = 3; m <=6; m++) {if(max<splices[m]) max = splices[m]}; }; print $0,max }' - 		| awk -F"	" 'BEGIN{OFS="	"} NR==1 {$7="spliceai_maxscore"; print $0} NR>1 {if ($6==".") {$7="."; print $0} else {print $0} }' - 		| awk -F"	" 'BEGIN{OFS="	"} NR==1 {$8="spliceai_rank"; print $6, $7, $8} NR>1 { if ($7==".") {$8 = 0} else { if ($7 >= 0.8) {$8 = 8} else {if ($7 >= 0.5) {$8 = 6} else {if ($7 >= 0.2) {$8 = 3} else {if ($7 >= 0.15) {$8 = 1} else {$8 = 0}}} }}; print $6, $7, $8}' -  > temp/spliceai.test_trio__1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,X,Y.tsv.cut
		
[+] Loading samtools 1.9  ... 
[+] Loading singularity  on cn2640 
[+] Loading VCF-kit 0.1.6  ... 
[Thu Jul  4 14:21:14 2019]
Finished job 0.
1 of 1 steps (100%) done
